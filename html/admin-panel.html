<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../bilder/favicon-32x32.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/admin-panel.css">
    <title>Admin Panel - Zoo School Project</title>

</head>
<body>
    <!-- Header -->
    <header id="Header">
        <h1>Admin Panel</h1>
    </header>

    <!-- Admin Container -->
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <h2>Navigation</h2>
            <ul>
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#tier-section">Tiere verwalten</a></li>
                <li><a href="#gebaude-section">Gehege verwalten</a></li>
                <li><a href="#pfleger-section">Pfleger</a></li>
                <li><a href="#visitors">Besucherinformationen</a></li>
                <li><a href="/logout">Logout</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard -->
            <section id="dashboard" class="dashboard">
                <div class="dashboard-card" id="tier">
                    <h3>Tiere</h3>
                    <p>50</p>
                </div>
                <div class="dashboard-card" id="gebaude">
                    <h3>Gehege</h3>
                    <p>10</p>
                </div>
                <div class="dashboard-card">
                    <h3>Besucher heute</h3>
                    <p>120</p>
                </div>
                <div class="dashboard-card">
                    <h3>Fütterungen</h3>
                    <p>15</p>
                </div>
            </section>

            <div id="tier-section-div">
                <!-- Add Animal Form -->
                <section id="tier-section" class="form-container">
                    <h2>Neues Tier hinzufügen</h2>
                </section>

                <div id="update-tier-section">
                    <h2>Update Tier</h2>
                    <input type="number" id="update-tier-id">
                    <button type="button" id="update-tier-btn">Auswählen</button>
                    <div id="update-tier-section-form">

                    </div>
                </div>
            </div>

             <div id="gebaude-section-div">
                <section id="gebaude-section" class="form-container">
                    <h2>Neues Gebaude hinzufügen</h2>
                </section>

                 <div id="update-gebaude-section">
                     <h2>Update Gebaude</h2>
                     <input type="number" id="update-gebaude-id">
                     <button type="button" id="update-gebaude-btn">Auswählen</button>
                     <div id="update-gebaude-section-form">

                     </div>
             </div>
             </div>

            <div id="pfleger-section-div">
                <section id="pfleger-section" class="form-container">
                    <h2>Neuen Pfleger hinzufügen</h2>
                </section>

                <div id="update-pfleger-section">
                    <h2>Update Pfleger</h2>
                    <input type="number" id="update-pfleger-id">
                    <button type="button" id="update-pfleger-btn">Auswählen</button>
                    <div id="update-pfleger-section-form">

                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer id="Footer">
        <p>&copy; 2024 Zoo School Project. Alle Rechte vorbehalten.</p>
    </footer>

</body>
<script type="module">
    import { getHeader, getFooter, countElement } from './../script/read.js';
    import { setup_create_tier_form, create_and_send_tier } from './../script/template/create/create-tier.js';
    import {setup_create_gebaude_form, create_and_send_gebaude} from "../script/template/create/gebaude.js";
    import {setup_update_tier, update_and_send_tier} from "../script/template/update/tier.js";
    import {setup_create_pfleger_form} from "../script/template/create/create-pfleger.js";
    import {create_and_send_pfleger} from "../script/template/create/create-pfleger.js";
    import {setup_update_pfleger} from "../script/template/update/pfleger.js";
    import {update_and_send_pfleger} from "../script/template/update/pfleger.js";
    import {setup_update_gebaude, update_and_send_gebaude} from "../script/template/update/gebaude.js";


    var count_tier = await countElement("tiere");
    var count_gehege = await countElement("gebaude");
    console.log(count_tier);
    document.getElementById("tier").querySelector("p").innerText = count_tier;
    document.getElementById("gebaude").querySelector("p").innerText = count_gehege;

    // #region tier
    var response = await fetch("server/template/create/tier")
        .then(response => response.text())
        .then(async data => {
            // Check if the response contains the word "Forbidden"
            const containsForbidden = data.includes("Forbidden");

            if (containsForbidden) {
                console.error("Response contains forbidden content.");
                return; // Exit the function if forbidden content is found
            } else {
                document.getElementById("tier-section").innerHTML += data;
                await setup_create_tier_form();
                await create_and_send_tier();
            }
        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });


    document.getElementById("update-tier-btn").addEventListener('click', async function (event) {
        event.preventDefault();
        var tierID = document.getElementById("update-tier-id").value
        console.log(tierID)
        var response = await fetch("/server/template/update/tier?id=" + tierID)
            .then(response => response.text())
            .then(async data => {
                console.log(data)
                // Check if the response contains the word "Forbidden"
                const containsForbidden = data.includes("Forbidden");

                if (containsForbidden) {
                    console.error("Response contains forbidden content.");
                    return; // Exit the function if forbidden content is found
                } else {
                    document.getElementById("update-tier-section-form").innerHTML = data;
                    await setup_update_tier();
                }
            })
            .catch(error => {
                console.error("Error fetching data:", error);
            });
    })
    // #endregion

    // #region gebaude
    var response = await fetch("/server/template/create/gebaude")
        .then(response => response.text())
        .then(async data => {
            // Check if the response contains the word "Forbidden"
            const containsForbidden = data.includes("Forbidden");

            if (containsForbidden) {
                console.error("Response contains forbidden content.");
                return; // Exit the function if forbidden content is found
            } else {
                document.getElementById("gebaude-section").innerHTML += data;
                await setup_create_gebaude_form()
                await create_and_send_gebaude()
            }
        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });

    document.getElementById("update-gebaude-btn").addEventListener('click', async function (event) {
        event.preventDefault();
        var gebaudeID = document.getElementById("update-gebaude-id").value
        console.log(gebaudeID)
        var response = await fetch("/server/template/update/gebaude?id=" + gebaudeID)
            .then(response => response.text())
            .then(async data => {
                console.log(data)
                // Check if the response contains the word "Forbidden"
                const containsForbidden = data.includes("Forbidden");

                if (containsForbidden) {
                    console.error("Response contains forbidden content.");
                    return; // Exit the function if forbidden content is found
                } else {
                    document.getElementById("update-gebaude-section-form").innerHTML = data;
                    await setup_update_gebaude()
                }
            })
            .catch(error => {
                console.error("Error fetching data:", error);
            });
    })
    // #endregion

    // #region Pfleger

    var response = await fetch("/server/template/create/pfleger")
        .then(response => response.text())
        .then(async data => {
            // Check if the response contains the word "Forbidden"
            const containsForbidden = data.includes("Forbidden");

            if (containsForbidden) {
                console.error("Response contains forbidden content.");
                return; // Exit the function if forbidden content is found
            } else {
                document.getElementById("pfleger-section").innerHTML += data;
                await setup_create_pfleger_form()
                await create_and_send_pfleger()
            }
        })
        .catch(error => {
            console.error("Error fetching data:", error);
        });

    document.getElementById("update-pfleger-btn").addEventListener('click', async function (event) {
        event.preventDefault();
        var pflegerID = document.getElementById("update-pfleger-id").value
        console.log(pflegerID)
        var response = await fetch("/server/template/update/pfleger?id=" + pflegerID)
            .then(response => response.text())
            .then(async data => {
                console.log(data)
                // Check if the response contains the word "Forbidden"
                const containsForbidden = data.includes("Forbidden");

                if (containsForbidden) {
                    console.error("Response contains forbidden content.");
                    return; // Exit the function if forbidden content is found
                } else {
                    document.getElementById("update-pfleger-section-form").innerHTML = data;
                    await setup_update_pfleger()
                }
            })
            .catch(error => {
                console.error("Error fetching data:", error);
            });
    })

    // #endregion


    await getHeader();
    await getFooter();

    window.onload = function() {
        if(!window.location.hash) {
            window.location = window.location + '#loaded';
            window.location.reload();
        }
    }

</script>
</html>